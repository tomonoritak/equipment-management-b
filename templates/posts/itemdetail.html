{% extends "base.html" %}
{% load static %}
{% block content %}

<style>
    .container {
        width: 80%; /* ページ幅の80%に設定 */
        min-width: 500px; /* 幅が500px以下にならないように設定 */
        margin: 50px auto; /* 横方向の中央揃え（上下50pxの余白を設定） */
        background-color: #fff; /* 背景色を白に設定 */
        border-radius: 5px; /* 角を5px丸くする */
        text-align: center; /* テキストを中央揃え */
        display: flex; /* フレックスボックスでレイアウト */
        flex-direction: column; /* コンテンツを縦方向に並べる */
        align-items: center; /* コンテンツを中央揃え */
        justify-content: center; /* コンテンツを中央に配置 */
        height: auto; /* 高さはコンテンツに応じて自動調整 */
      }
      
      .box {
        width: 100%;
        margin: 10px auto;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        border-radius: 10px;
      }
      
      .form-group {
        margin-bottom: 15px; /* 下部に15pxの余白を設定 */
        display: flex; /* フレックスボックスでレイアウト */
        align-items: center; /* コンテンツを垂直方向に中央に揃える */
      }
      
      .form-group label {
        margin-right: 10px; /* ラベルと入力フィールドの間に10pxの余白を設定 */
        flex: 0 0 150px; /* ラベルの幅を固定 */
        text-align: left; /* ラベルのテキストを右揃え */
        font-weight: bold; /* 文字を太字にする */
      }
      
      .form-group input[type="text"],
      .form-group input[type="number"],
      .form-group textarea,
      .form-group input[type="file"],
      .form-group select {
        flex: 1; /* 入力フィールドを残りのスペースに合わせて広げる */
        padding: 10px; /* 内側の余白を10pxに設定 */
        border: 1px solid #ccc; /* 薄い灰色のボーダーを設定 */
        border-radius: 5px; /* 角を5px丸くする */
        max-width: 1500px; /* 最大幅を500pxに制限 */
      }
      
      /* ボタンの基本スタイル */
      .btn {
        padding: 10px 20px; /* 内側の余白（上下10px、左右20px） */
        background-color: #007bff; /* 背景色（青） */
        border: none; /* ボーダーなし */
        border-radius: 5px; /* 角を5px丸くする */
        color: white; /* 文字色を白に設定 */
        font-size: 16px; /* 文字サイズを16pxに設定 */
        text-align: center; /* 文字を中央揃え */
        text-decoration: none; /* テキストの下線を削除 */
        display: inline-block; /* 要素をインラインブロックにして、幅を設定 */
        transition: background-color 0.3s ease, transform 0.3s ease; /* 背景色とトランスフォームの遷移効果 */
      }

</style>

<div class="container">
    <h1>{{ post.name }}</h1>
    <a href="{% url 'Posts:itemedit' post.pk %}" class="btn">編集</a>
    {% if post.image %}
        <img src="{{ post.image.url }}" alt="{{ post.name }}" style="display: block; margin: 20px auto;">
    {% endif %}
    <p>説明: {{ post.description }}</p>
    <p>カテゴリ: {{ post.category }}</p>
    <p>
        ステータス: 
        {% if post.status == "承認" %}
            <span style="color: green;">{{ post.status }}</span>
        {% elif post.status == "承認待ち" %}
            <span style="color: red;">{{ post.status }}</span>
        {% endif %}
    </p>
    <p>設置場所: {{ post.location }}</p>
    <p>在庫数: {{ post.stock_quantity }}</p>

    {% if post.status == '承認' %}
        <h2>在庫数を変更</h2>
        <form method="post" action="{% url 'Posts:stock_quantity_update' post.pk %}">
            {% csrf_token %}
            <div class="form-group">
                <label for="id_stock_quantity">新しい在庫数:</label>
                <input type="number" id="id_stock_quantity" name="stock_quantity" value="{{ post.stock_quantity }}" min="0" required>
                <button type="submit" class="btn">更新</button>
            </div>
        </form>
        <div class="history">
            <h2>在庫数の変更履歴</h2>
             <!-- 最新の10個程度を表示したい    済 -->
             <ul>
                {% for history in stock_histories %}
                    <li>{{ history.changed_at }}: 在庫数 {{ history.stock_quantity }}</li>
                {% empty %}
                    <li>変更履歴はありません。</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}
    
<!-- 管理者のみ表示    済 -->

    <h2>承認依頼</h2>
    {% if user.is_authenticated %}
        {% if post.status == '承認待ち' %}
            <div class="approval">
                <p>追加日時: {{ post.created_at }}</p>
                <p>ステータス: {{ post.status }}</p>
                <form method="post" action="{% url 'Posts:item_approve' post.pk %}">
                    {% csrf_token %}
                    <button type="submit" class="btn">承認</button>
                </form>
            </div>
        {% else %}
            <p>承認されています。</p>
        {% endif %}
    {% else %}
        <p>管理者ではないため、承認依頼は表示されません。</p>
    {% endif %}
</div>
{% endblock content %}